<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow
                          http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd"
      parent="parent-flow">

    <on-start>
            <evaluate expression="adminService.getBodyPartList()" result="flowScope.bodyParts"></evaluate>
            <evaluate expression="adminService.getSymptomTypeList()" result="flowScope.symptomTypes"></evaluate>
            <evaluate expression="adminService.getTestList()" result="flowScope.tests"></evaluate>
    </on-start>

    <view-state id="entityForm" model="entity" view="symptomForm.jsp">
        <transition on="saveAndNew" to="entityForm">
            <evaluate expression="symptomBean" result="entity"/>
        </transition>
        <transition on="addNewBodyPart" to="addNewBodyPart"></transition>
        <transition on="addNewSymptomType" to="addNewSymptomType"></transition>
        <transition on="addNewTest" to="addNewTest"></transition>
    </view-state>

    <subflow-state id="addNewBodyPart" subflow="bodyPart">
        <input name="entity" value="bodyPartBean"/>
        <transition on="saveAndBack" to="entityForm">
            <evaluate expression="adminService.getBodyPartList()" result="flowScope.bodyParts"></evaluate>
            <evaluate expression="entity.setBodyPart(currentEvent.attributes.entity)"></evaluate>
        </transition>
        <transition on="back" to="entityForm">
        </transition>
    </subflow-state>

    <subflow-state id="addNewSymptomType" subflow="symptomType">
        <input name="entity" value="symptomTypeBean"/>
        <transition on="saveAndBack" to="entityForm">
            <evaluate expression="adminService.getSymptomTypeList()" result="flowScope.symptomTypes"></evaluate>
            <evaluate expression="entity.setSymptomType(currentEvent.attributes.entity)"></evaluate>
        </transition>
        <transition on="back" to="entityForm">
        </transition>
    </subflow-state>

    <subflow-state id="addNewTest" subflow="test">
        <input name="entity" value="testBean"/>
        <transition on="saveAndBack" to="entityForm">
            <evaluate expression="adminService.getTestList()" result="flowScope.tests"></evaluate>
            <evaluate expression="entity.setTest(currentEvent.attributes.entity)"></evaluate>
        </transition>
        <transition on="back" to="entityForm">
        </transition>
    </subflow-state>

</flow>